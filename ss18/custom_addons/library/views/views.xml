<odoo>
  <data>

    <record id="view_library_book_list" model="ir.ui.view">
      <field name="name">library.book.list</field>
      <field name="model">library.book</field>
      <field name="arch" type="xml">
        <list decoration-danger="state=='borrowed'" decoration-success="state=='available'" decoration-muted="state=='lost'">
          <field name="name"/>
          <field name="isbn"/>
          <field name="category_id"/>
          <field name="author_ids" widget="many2many_tags"/>
          <field name="state" widget="badge"/>
          <field name="condition" widget="priority"/>
        </list>
      </field>
    </record>

    <record id="view_library_book_form" model="ir.ui.view">
      <field name="name">library.book.form</field>
      <field name="model">library.book</field>
      <field name="arch" type="xml">
        <form>
          <!-- HEADER với Status Bar -->
          <header>
            <field name="state" widget="statusbar" options="{'clickable': True}"/>
          </header>

          <sheet>
            <!-- TIÊU ĐỀ -->
            <div class="oe_title">
              <h1>
                <field name="name" placeholder="Nhập tên sách..."/>
              </h1>
              <h4>
                <field name="isbn" placeholder="Nhập mã ISBN..."/>
              </h4>
              <field name="condition" widget="priority"/>
            </div>

            <!-- THÔNG TIN CƠ BẢN (2 cột) -->
            <group>
              <group string="Thông tin Sách">
                <field name="category_id" options="{'no_create': True}"/>
                <field name="author_ids" widget="many2many_tags"/>
                <field name="purchase_date"/>
              </group>
              <group string="Tính Toán">
                <field name="days_since_purchase"/>
                <field name="total_loans"/>
                <field name="short_description"/>
              </group>
            </group>

            <!-- NOTEBOOK (2 TABS) -->
            <notebook>
              <!-- TAB 1: LỊCH SỬ MƯỢN -->
              <page string="Lịch sử mượn trả" name="loan_history">
                <field name="loan_ids">
                  <list editable="bottom">
                    <field name="borrower_name"/>
                    <field name="borrow_date"/>
                    <field name="return_date"/>
                    <field name="duration" readonly="1"/>
                    <field name="is_returned" widget="boolean"/>
                  </list>
                </field>
              </page>

              <!-- TAB 2: THÔNG TIN KHO (BẢO MẬT) -->
              <page string="Thông tin Kho" name="warehouse_info">
                <group>
                  <field name="purchase_price"/>
                </group>
                <group>
                  <field name="notes"/>
                </group>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>

    <record id="view_library_book_search" model="ir.ui.view">
      <field name="name">library.book.search</field>
      <field name="model">library.book</field>
      <field name="arch" type="xml">
        <search>
          <field name="name"/>
          <field name="isbn"/>
          
          <separator/>
          
          <filter name="filter_available" string="Sách có sẵn" domain="[('state','=','available')]"/>
          <filter name="filter_draft" string="Sách mới nhập" domain="[('state','=','draft')]"/>
          <filter name="filter_borrowed" string="Đang mượn" domain="[('state','=','borrowed')]"/>
          <filter name="filter_lost" string="Đã mất" domain="[('state','=','lost')]"/>
          
          <separator/>
          
          <group expand="1" string="Gom nhóm theo">
            <filter name="grp_category" string="Thể loại" context="{'group_by': 'category_id'}"/>
            <filter name="grp_author" string="Tác giả" context="{'group_by': 'author_ids'}"/>
            <filter name="grp_condition" string="Tình trạng" context="{'group_by': 'condition'}"/>
          </group>
        </search>
      </field>
    </record>

    <record id="view_library_category_list" model="ir.ui.view">
      <field name="name">library.category.list</field>
      <field name="model">library.category</field>
      <field name="arch" type="xml">
        <list>
          <field name="name"/>
        </list>
      </field>
    </record>

    <!-- 5. FORM VIEW - library.category -->
    <record id="view_library_category_form" model="ir.ui.view">
      <field name="name">library.category.form</field>
      <field name="model">library.category</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <field name="name"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="view_library_author_list" model="ir.ui.view">
      <field name="name">library.author.list</field>
      <field name="model">library.author</field>
      <field name="arch" type="xml">
        <list>
          <field name="name"/>
          <field name="bio"/>
        </list>
      </field>
    </record>

    <!-- 7. FORM VIEW - library.author -->
    <record id="view_library_author_form" model="ir.ui.view">
      <field name="name">library.author.form</field>
      <field name="model">library.author</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <field name="name"/>
              <field name="bio"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="view_library_loan_list" model="ir.ui.view">
      <field name="name">library.loan.list</field>
      <field name="model">library.loan</field>
      <field name="arch" type="xml">
        <list>
          <field name="borrower_name"/>
          <field name="book_id"/>
          <field name="borrow_date"/>
          <field name="return_date"/>
          <field name="duration"/>
          <field name="is_returned" widget="boolean"/>
        </list>
      </field>
    </record>

    <!-- 9. FORM VIEW - library.loan -->
    <record id="view_library_loan_form" model="ir.ui.view">
      <field name="name">library.loan.form</field>
      <field name="model">library.loan</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <group>
                <field name="borrower_name"/>
                <field name="book_id"/>
              </group>
              <group>
                <field name="borrow_date"/>
                <field name="return_date"/>
                <field name="duration" readonly="1"/>
              </group>
            </group>
            <field name="is_returned"/>
          </sheet>
        </form>
      </field>
    </record>

  </data>
</odoo>
